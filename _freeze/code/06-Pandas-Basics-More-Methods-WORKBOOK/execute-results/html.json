{
  "hash": "2164fa0cced3ab3086760f9a271d2c8b",
  "result": {
    "markdown": "# Pandas Basics — More Useful Methods — Workbook\n\n___\n\n## Dataset\n### *The Pudding*'s Film Dialogue Data\n\nThe dataset that we're working with in this lesson is taken from Hannah Andersen and Matt Daniels's *Pudding* essay, [\"Film Dialogue from 2,000 screenplays, Broken Down by Gender and Age\"](https://pudding.cool/2017/03/film-dialogue/). The dataset provides information about 2,000 films from 1925 to 2015, including characters’ names, genders, ages, how many words each character spoke in each film, the release year of each film, and how much money the film grossed. They included character gender information because they wanted to contribute data to a broader conversation about how \"white men dominate movie roles.\"\n\n___\n\n## Import Pandas\n\nTo use the Pandas library, we first need to `import` it.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:45.497099Z\",\"start_time\":\"2022-11-07T10:54:45.186181Z\"}' execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\n```\n:::\n\n\n## Change Display Settings\n\nBy default, Pandas will display 60 rows and 20 columns. I often change [Pandas' default display settings](https://pandas.pydata.org/pandas-docs/stable/user_guide/options.html) to show more rows or columns.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:46.031855Z\",\"start_time\":\"2022-11-07T10:54:46.025428Z\"}' execution_count=2}\n``` {.python .cell-code}\npd.options.display.max_rows = 200\n```\n:::\n\n\n## Get Data\n\nFor this notebook, we're going to read in a slightly less clean version of the Pudding data.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:46.893894Z\",\"start_time\":\"2022-11-07T10:54:46.836238Z\"}' execution_count=3}\n``` {.python .cell-code}\nfilm_df = pd.read_csv('../data/Pudding/Pudding-Film-Dialogue-Salty.csv', delimiter=\",\", encoding='utf-8')\n```\n:::\n\n\n## Overview\n\nTo look at a random *n* number of rows in a DataFrame, we can use a method called `.sample()`.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:47.333404Z\",\"start_time\":\"2022-11-07T10:54:47.300806Z\"}' execution_count=4}\n``` {.python .cell-code}\nfilm_df.sample(5)\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>script_id</th>\n      <th>imdb_character_name</th>\n      <th>words</th>\n      <th>gender</th>\n      <th>age</th>\n      <th>imdb_id</th>\n      <th>title</th>\n      <th>year</th>\n      <th>gross</th>\n      <th>proportion_of_dialogue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>9675</th>\n      <td>3113</td>\n      <td>marge jenkins</td>\n      <td>198</td>\n      <td>f</td>\n      <td>45.0</td>\n      <td>tt0120789</td>\n      <td>Pleasantville</td>\n      <td>1998</td>\n      <td>75.0</td>\n      <td>0.010464</td>\n    </tr>\n    <tr>\n      <th>11111</th>\n      <td>3569</td>\n      <td>gideon</td>\n      <td>3870</td>\n      <td>m</td>\n      <td>NaN</td>\n      <td>tt0100791</td>\n      <td>To Sleep with Anger</td>\n      <td>1990</td>\n      <td>2.0</td>\n      <td>0.195712</td>\n    </tr>\n    <tr>\n      <th>2841</th>\n      <td>1325</td>\n      <td>ray reddy</td>\n      <td>202</td>\n      <td>m</td>\n      <td>32.0</td>\n      <td>tt0286106</td>\n      <td>Signs</td>\n      <td>2002</td>\n      <td>341.0</td>\n      <td>0.037208</td>\n    </tr>\n    <tr>\n      <th>893</th>\n      <td>851</td>\n      <td>receptionist</td>\n      <td>138</td>\n      <td>f</td>\n      <td>NaN</td>\n      <td>tt0800240</td>\n      <td>Deception</td>\n      <td>2008</td>\n      <td>5.0</td>\n      <td>0.016165</td>\n    </tr>\n    <tr>\n      <th>22769</th>\n      <td>9098</td>\n      <td>frankie</td>\n      <td>215</td>\n      <td>m</td>\n      <td>61.0</td>\n      <td>tt0267891</td>\n      <td>The Ringer</td>\n      <td>2005</td>\n      <td>48.0</td>\n      <td>0.043052</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nGenerate information about all the columns in the data \n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:47.764925Z\",\"start_time\":\"2022-11-07T10:54:47.729781Z\"}' execution_count=5}\n``` {.python .cell-code}\nfilm_df.describe()\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>script_id</th>\n      <th>words</th>\n      <th>age</th>\n      <th>year</th>\n      <th>gross</th>\n      <th>proportion_of_dialogue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>23052.000000</td>\n      <td>23052.000000</td>\n      <td>18266.000000</td>\n      <td>23052.000000</td>\n      <td>19390.000000</td>\n      <td>23052.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>4195.580904</td>\n      <td>907.870684</td>\n      <td>42.386839</td>\n      <td>1998.133828</td>\n      <td>106.805570</td>\n      <td>0.086512</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>2473.518048</td>\n      <td>1399.538583</td>\n      <td>59.714730</td>\n      <td>14.745342</td>\n      <td>145.992394</td>\n      <td>0.107740</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>280.000000</td>\n      <td>101.000000</td>\n      <td>3.000000</td>\n      <td>1929.000000</td>\n      <td>0.000000</td>\n      <td>0.001537</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>2095.000000</td>\n      <td>193.000000</td>\n      <td>30.000000</td>\n      <td>1992.000000</td>\n      <td>22.000000</td>\n      <td>0.019771</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>3694.000000</td>\n      <td>396.000000</td>\n      <td>39.000000</td>\n      <td>2001.000000</td>\n      <td>56.000000</td>\n      <td>0.042421</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>6234.000000</td>\n      <td>980.000000</td>\n      <td>50.000000</td>\n      <td>2009.000000</td>\n      <td>136.000000</td>\n      <td>0.104166</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>9254.000000</td>\n      <td>28102.000000</td>\n      <td>2013.000000</td>\n      <td>2015.000000</td>\n      <td>1798.000000</td>\n      <td>0.923422</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Rename Columns\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:48.215367Z\",\"start_time\":\"2022-11-07T10:54:48.206575Z\"}' execution_count=6}\n``` {.python .cell-code}\nfilm_df = film_df.rename(columns={'imdb_character_name': 'character', 'year': 'release_year'})\n```\n:::\n\n\n## Clean and Transform Data\n\n### Pandas `.str` Methods\n\nRemember all the special things that you can do with Python strings aka [string methods](https://melaniewalsh.github.io/Intro-Cultural-Analytics/Python/String-Methods.html)?\n\nPandas has special [Pandas string methods](https://pandas.pydata.org/pandas-docs/stable/user_guide/text.html#string-methods), too. Many of them are very similar to Python string methods, except they will transform every single string value in a column, and we have to add `.str` to the method chain.\n\n| **Pandas String Method** | **Explanation**                                                                                   |\n|:-------------:|:---------------------------------------------------------------------------------------------------:|\n| df['column_name']`.str.lower()`         | makes the string in each row lowercase                                                                                |\n| df['column_name']`.str.upper()`         | makes the string in each row uppercase                                                |\n| df['column_name']`.str.title()`         | makes the string in each row titlecase                                                |\n| df['column_name']`.str.replace('old string', 'new string')`      | replaces `old string` with `new string` for each row |\n| df['column_name']`.str.contains('some string')`      | tests whether string in each row contains \"some string\" |\n| df['column_name']`.str.split('delim')`          | returns a list of substrings separated by the given delimiter |\n| df['column_name']`.str.join(list)`         | opposite of split(), joins the elements in the given list together using the string                                                                        |\n                                                            \n\nFor example, to transform every character's name in the \"character\" column from lowercase to title case, we can use `.str.title()` \n\nTo transform every character's name in the \"character\" column to lowercase, we can use `.str.lower()`\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:49.652044Z\",\"start_time\":\"2022-11-07T10:54:49.641459Z\"}' execution_count=7}\n``` {.python .cell-code}\nfilm_df['character']\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\n0                  betty\n1        carolyn johnson\n2                eleanor\n3        francesca johns\n4                  madge\n              ...       \n23047            maurice\n23048    monsieur d'arqu\n23049         mrs. potts\n23050           wardrobe\n23051         mrs. potts\nName: character, Length: 23052, dtype: object\n```\n:::\n:::\n\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:49.855008Z\",\"start_time\":\"2022-11-07T10:54:49.827214Z\"}' execution_count=8}\n``` {.python .cell-code}\nfilm_df['character'].str.title()\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\n0                  Betty\n1        Carolyn Johnson\n2                Eleanor\n3        Francesca Johns\n4                  Madge\n              ...       \n23047            Maurice\n23048    Monsieur D'Arqu\n23049         Mrs. Potts\n23050           Wardrobe\n23051         Mrs. Potts\nName: character, Length: 23052, dtype: object\n```\n:::\n:::\n\n\nThe transformation above was temporary. Change the DataFrame column \"character\" to title case permanently.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:50.188853Z\",\"start_time\":\"2022-11-07T10:54:50.185032Z\"}' execution_count=9}\n``` {.python .cell-code}\n#Your code here\n```\n:::\n\n\n## Filter with `.contains()`\n\nWe can use the `.str.contains()` to search for particular words or phrases in a column, such as \"Star Wars.\"\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:50.745242Z\",\"start_time\":\"2022-11-07T10:54:50.718059Z\"}' execution_count=10}\n``` {.python .cell-code}\nstar_wars_filter = film_df['title'].str.contains('Star Wars')\n```\n:::\n\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:50.947841Z\",\"start_time\":\"2022-11-07T10:54:50.897898Z\"}' tags='[\"output_scroll\",\"full-width\"]' execution_count=11}\n``` {.python .cell-code}\nfilm_df[star_wars_filter]\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>script_id</th>\n      <th>character</th>\n      <th>words</th>\n      <th>gender</th>\n      <th>age</th>\n      <th>imdb_id</th>\n      <th>title</th>\n      <th>release_year</th>\n      <th>gross</th>\n      <th>proportion_of_dialogue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>3017</th>\n      <td>1359</td>\n      <td>admiral ackbar</td>\n      <td>199</td>\n      <td>m</td>\n      <td>61.0</td>\n      <td>tt0086190</td>\n      <td>Star Wars: Episode VI - Return of the Jedi</td>\n      <td>1983</td>\n      <td>853.0</td>\n      <td>0.039096</td>\n    </tr>\n    <tr>\n      <th>3018</th>\n      <td>1359</td>\n      <td>ben 'obi-wan' k</td>\n      <td>462</td>\n      <td>m</td>\n      <td>69.0</td>\n      <td>tt0086190</td>\n      <td>Star Wars: Episode VI - Return of the Jedi</td>\n      <td>1983</td>\n      <td>853.0</td>\n      <td>0.090766</td>\n    </tr>\n    <tr>\n      <th>3019</th>\n      <td>1359</td>\n      <td>c-3po</td>\n      <td>881</td>\n      <td>m</td>\n      <td>37.0</td>\n      <td>tt0086190</td>\n      <td>Star Wars: Episode VI - Return of the Jedi</td>\n      <td>1983</td>\n      <td>853.0</td>\n      <td>0.173084</td>\n    </tr>\n    <tr>\n      <th>3020</th>\n      <td>1359</td>\n      <td>darth vader</td>\n      <td>381</td>\n      <td>m</td>\n      <td>48.0</td>\n      <td>tt0086190</td>\n      <td>Star Wars: Episode VI - Return of the Jedi</td>\n      <td>1983</td>\n      <td>853.0</td>\n      <td>0.074853</td>\n    </tr>\n    <tr>\n      <th>3021</th>\n      <td>1359</td>\n      <td>han solo</td>\n      <td>835</td>\n      <td>m</td>\n      <td>41.0</td>\n      <td>tt0086190</td>\n      <td>Star Wars: Episode VI - Return of the Jedi</td>\n      <td>1983</td>\n      <td>853.0</td>\n      <td>0.164047</td>\n    </tr>\n    <tr>\n      <th>3022</th>\n      <td>1359</td>\n      <td>lando calrissia</td>\n      <td>379</td>\n      <td>m</td>\n      <td>46.0</td>\n      <td>tt0086190</td>\n      <td>Star Wars: Episode VI - Return of the Jedi</td>\n      <td>1983</td>\n      <td>853.0</td>\n      <td>0.074460</td>\n    </tr>\n    <tr>\n      <th>3023</th>\n      <td>1359</td>\n      <td>luke skywalker</td>\n      <td>915</td>\n      <td>m</td>\n      <td>32.0</td>\n      <td>tt0086190</td>\n      <td>Star Wars: Episode VI - Return of the Jedi</td>\n      <td>1983</td>\n      <td>853.0</td>\n      <td>0.179764</td>\n    </tr>\n    <tr>\n      <th>3024</th>\n      <td>1359</td>\n      <td>princess leia</td>\n      <td>359</td>\n      <td>f</td>\n      <td>27.0</td>\n      <td>tt0086190</td>\n      <td>Star Wars: Episode VI - Return of the Jedi</td>\n      <td>1983</td>\n      <td>853.0</td>\n      <td>0.070530</td>\n    </tr>\n    <tr>\n      <th>3025</th>\n      <td>1359</td>\n      <td>the emperor</td>\n      <td>516</td>\n      <td>m</td>\n      <td>39.0</td>\n      <td>tt0086190</td>\n      <td>Star Wars: Episode VI - Return of the Jedi</td>\n      <td>1983</td>\n      <td>853.0</td>\n      <td>0.101375</td>\n    </tr>\n    <tr>\n      <th>3026</th>\n      <td>1359</td>\n      <td>yoda</td>\n      <td>163</td>\n      <td>m</td>\n      <td>19.0</td>\n      <td>tt0086190</td>\n      <td>Star Wars: Episode VI - Return of the Jedi</td>\n      <td>1983</td>\n      <td>853.0</td>\n      <td>0.032024</td>\n    </tr>\n    <tr>\n      <th>3027</th>\n      <td>1360</td>\n      <td>anakin skywalke</td>\n      <td>2061</td>\n      <td>m</td>\n      <td>21.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.274251</td>\n    </tr>\n    <tr>\n      <th>3028</th>\n      <td>1360</td>\n      <td>cliegg lars</td>\n      <td>152</td>\n      <td>m</td>\n      <td>62.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.020226</td>\n    </tr>\n    <tr>\n      <th>3029</th>\n      <td>1360</td>\n      <td>count dooku</td>\n      <td>321</td>\n      <td>m</td>\n      <td>80.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.042715</td>\n    </tr>\n    <tr>\n      <th>3030</th>\n      <td>1360</td>\n      <td>dexter jettster</td>\n      <td>151</td>\n      <td>m</td>\n      <td>67.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.020093</td>\n    </tr>\n    <tr>\n      <th>3031</th>\n      <td>1360</td>\n      <td>jar jar binks</td>\n      <td>294</td>\n      <td>m</td>\n      <td>29.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.039122</td>\n    </tr>\n    <tr>\n      <th>3032</th>\n      <td>1360</td>\n      <td>lama su</td>\n      <td>350</td>\n      <td>m</td>\n      <td>48.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.046574</td>\n    </tr>\n    <tr>\n      <th>3033</th>\n      <td>1360</td>\n      <td>mace windu</td>\n      <td>365</td>\n      <td>m</td>\n      <td>54.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.048570</td>\n    </tr>\n    <tr>\n      <th>3034</th>\n      <td>1360</td>\n      <td>madame jocasta</td>\n      <td>331</td>\n      <td>f</td>\n      <td>82.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.044045</td>\n    </tr>\n    <tr>\n      <th>3035</th>\n      <td>1360</td>\n      <td>obi-wan kenobi</td>\n      <td>1477</td>\n      <td>m</td>\n      <td>31.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.196540</td>\n    </tr>\n    <tr>\n      <th>3036</th>\n      <td>1360</td>\n      <td>padme</td>\n      <td>668</td>\n      <td>f</td>\n      <td>21.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.088889</td>\n    </tr>\n    <tr>\n      <th>3037</th>\n      <td>1360</td>\n      <td>queen jamillia</td>\n      <td>135</td>\n      <td>f</td>\n      <td>25.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.017964</td>\n    </tr>\n    <tr>\n      <th>3038</th>\n      <td>1360</td>\n      <td>supreme chancel</td>\n      <td>576</td>\n      <td>m</td>\n      <td>58.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.076647</td>\n    </tr>\n    <tr>\n      <th>3039</th>\n      <td>1360</td>\n      <td>taun we</td>\n      <td>139</td>\n      <td>f</td>\n      <td>40.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.018496</td>\n    </tr>\n    <tr>\n      <th>3040</th>\n      <td>1360</td>\n      <td>watto</td>\n      <td>140</td>\n      <td>m</td>\n      <td>49.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.018629</td>\n    </tr>\n    <tr>\n      <th>3041</th>\n      <td>1360</td>\n      <td>yoda</td>\n      <td>355</td>\n      <td>m</td>\n      <td>58.0</td>\n      <td>tt0121765</td>\n      <td>Star Wars: Episode II - Attack of the Clones</td>\n      <td>2002</td>\n      <td>465.0</td>\n      <td>0.047239</td>\n    </tr>\n    <tr>\n      <th>3058</th>\n      <td>1362</td>\n      <td>ben obi-wan ken</td>\n      <td>995</td>\n      <td>m</td>\n      <td>63.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.099084</td>\n    </tr>\n    <tr>\n      <th>3059</th>\n      <td>1362</td>\n      <td>c-3po</td>\n      <td>1506</td>\n      <td>m</td>\n      <td>31.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.149970</td>\n    </tr>\n    <tr>\n      <th>3060</th>\n      <td>1362</td>\n      <td>cmdr. praji (im</td>\n      <td>117</td>\n      <td>m</td>\n      <td>42.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.011651</td>\n    </tr>\n    <tr>\n      <th>3061</th>\n      <td>1362</td>\n      <td>darth vader</td>\n      <td>492</td>\n      <td>m</td>\n      <td>46.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.048994</td>\n    </tr>\n    <tr>\n      <th>3062</th>\n      <td>1362</td>\n      <td>general dodonna</td>\n      <td>185</td>\n      <td>m</td>\n      <td>66.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.018423</td>\n    </tr>\n    <tr>\n      <th>3063</th>\n      <td>1362</td>\n      <td>grand moff tark</td>\n      <td>411</td>\n      <td>m</td>\n      <td>64.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.040928</td>\n    </tr>\n    <tr>\n      <th>3064</th>\n      <td>1362</td>\n      <td>greedo</td>\n      <td>103</td>\n      <td>m</td>\n      <td>33.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.010257</td>\n    </tr>\n    <tr>\n      <th>3065</th>\n      <td>1362</td>\n      <td>han solo</td>\n      <td>1730</td>\n      <td>m</td>\n      <td>35.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.172276</td>\n    </tr>\n    <tr>\n      <th>3066</th>\n      <td>1362</td>\n      <td>jabba</td>\n      <td>185</td>\n      <td>m</td>\n      <td>NaN</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.018423</td>\n    </tr>\n    <tr>\n      <th>3067</th>\n      <td>1362</td>\n      <td>luke skywalker</td>\n      <td>2485</td>\n      <td>m</td>\n      <td>26.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.247461</td>\n    </tr>\n    <tr>\n      <th>3068</th>\n      <td>1362</td>\n      <td>princess leia o</td>\n      <td>636</td>\n      <td>f</td>\n      <td>21.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.063334</td>\n    </tr>\n    <tr>\n      <th>3069</th>\n      <td>1362</td>\n      <td>red leader</td>\n      <td>241</td>\n      <td>m</td>\n      <td>37.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.023999</td>\n    </tr>\n    <tr>\n      <th>3070</th>\n      <td>1362</td>\n      <td>red three (bigg</td>\n      <td>523</td>\n      <td>m</td>\n      <td>38.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.052081</td>\n    </tr>\n    <tr>\n      <th>3071</th>\n      <td>1362</td>\n      <td>stormtrooper</td>\n      <td>122</td>\n      <td>m</td>\n      <td>36.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.012149</td>\n    </tr>\n    <tr>\n      <th>3072</th>\n      <td>1362</td>\n      <td>uncle owen</td>\n      <td>311</td>\n      <td>m</td>\n      <td>61.0</td>\n      <td>tt0076759</td>\n      <td>Star Wars: Episode IV - A New Hope</td>\n      <td>1977</td>\n      <td>1798.0</td>\n      <td>0.030970</td>\n    </tr>\n    <tr>\n      <th>10591</th>\n      <td>3427</td>\n      <td>anakin skywalke</td>\n      <td>3768</td>\n      <td>m</td>\n      <td>24.0</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.271138</td>\n    </tr>\n    <tr>\n      <th>10592</th>\n      <td>3427</td>\n      <td>c-3po</td>\n      <td>312</td>\n      <td>m</td>\n      <td>59.0</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.022451</td>\n    </tr>\n    <tr>\n      <th>10593</th>\n      <td>3427</td>\n      <td>Clone Jedi Knig</td>\n      <td>104</td>\n      <td>m</td>\n      <td>NaN</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.007484</td>\n    </tr>\n    <tr>\n      <th>10594</th>\n      <td>3427</td>\n      <td>darth sldious</td>\n      <td>244</td>\n      <td>m</td>\n      <td>NaN</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.017558</td>\n    </tr>\n    <tr>\n      <th>10595</th>\n      <td>3427</td>\n      <td>general grievou</td>\n      <td>317</td>\n      <td>m</td>\n      <td>33.0</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.022811</td>\n    </tr>\n    <tr>\n      <th>10596</th>\n      <td>3427</td>\n      <td>Ki-Adi-Mundi /</td>\n      <td>107</td>\n      <td>m</td>\n      <td>40.0</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.007700</td>\n    </tr>\n    <tr>\n      <th>10597</th>\n      <td>3427</td>\n      <td>Mace Windu</td>\n      <td>407</td>\n      <td>m</td>\n      <td>57.0</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.029287</td>\n    </tr>\n    <tr>\n      <th>10598</th>\n      <td>3427</td>\n      <td>mon mothma</td>\n      <td>127</td>\n      <td>f</td>\n      <td>28.0</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.009139</td>\n    </tr>\n    <tr>\n      <th>10599</th>\n      <td>3427</td>\n      <td>obi-wan kenobi</td>\n      <td>3181</td>\n      <td>m</td>\n      <td>34.0</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.228898</td>\n    </tr>\n    <tr>\n      <th>10600</th>\n      <td>3427</td>\n      <td>Padme</td>\n      <td>1561</td>\n      <td>f</td>\n      <td>24.0</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.112326</td>\n    </tr>\n    <tr>\n      <th>10601</th>\n      <td>3427</td>\n      <td>senator bail or</td>\n      <td>479</td>\n      <td>m</td>\n      <td>50.0</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.034468</td>\n    </tr>\n    <tr>\n      <th>10602</th>\n      <td>3427</td>\n      <td>Supreme Chancel</td>\n      <td>2367</td>\n      <td>m</td>\n      <td>61.0</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.170325</td>\n    </tr>\n    <tr>\n      <th>10603</th>\n      <td>3427</td>\n      <td>yoda</td>\n      <td>923</td>\n      <td>m</td>\n      <td>61.0</td>\n      <td>tt0121766</td>\n      <td>Star Wars: Episode III - Revenge of the Sith</td>\n      <td>2005</td>\n      <td>515.0</td>\n      <td>0.066417</td>\n    </tr>\n    <tr>\n      <th>10604</th>\n      <td>3433</td>\n      <td>admiral piett</td>\n      <td>232</td>\n      <td>m</td>\n      <td>43.0</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.025127</td>\n    </tr>\n    <tr>\n      <th>10605</th>\n      <td>3433</td>\n      <td>ben (obi-wan) k</td>\n      <td>177</td>\n      <td>m</td>\n      <td>66.0</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.019170</td>\n    </tr>\n    <tr>\n      <th>10606</th>\n      <td>3433</td>\n      <td>C-3PO</td>\n      <td>1474</td>\n      <td>m</td>\n      <td>34.0</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.159645</td>\n    </tr>\n    <tr>\n      <th>10607</th>\n      <td>3433</td>\n      <td>captain needa</td>\n      <td>108</td>\n      <td>m</td>\n      <td>42.0</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.011697</td>\n    </tr>\n    <tr>\n      <th>10608</th>\n      <td>3433</td>\n      <td>darth vader</td>\n      <td>853</td>\n      <td>m</td>\n      <td>49.0</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.092386</td>\n    </tr>\n    <tr>\n      <th>10609</th>\n      <td>3433</td>\n      <td>general veers</td>\n      <td>114</td>\n      <td>m</td>\n      <td>45.0</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.012347</td>\n    </tr>\n    <tr>\n      <th>10610</th>\n      <td>3433</td>\n      <td>han solo</td>\n      <td>2024</td>\n      <td>m</td>\n      <td>38.0</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.219214</td>\n    </tr>\n    <tr>\n      <th>10611</th>\n      <td>3433</td>\n      <td>lando calrissia</td>\n      <td>798</td>\n      <td>m</td>\n      <td>43.0</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.086429</td>\n    </tr>\n    <tr>\n      <th>10612</th>\n      <td>3433</td>\n      <td>luke skywalker</td>\n      <td>1282</td>\n      <td>m</td>\n      <td>29.0</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.138850</td>\n    </tr>\n    <tr>\n      <th>10613</th>\n      <td>3433</td>\n      <td>princess leia</td>\n      <td>1025</td>\n      <td>f</td>\n      <td>24.0</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.111015</td>\n    </tr>\n    <tr>\n      <th>10614</th>\n      <td>3433</td>\n      <td>rebel force gen</td>\n      <td>168</td>\n      <td>m</td>\n      <td>50.0</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.018196</td>\n    </tr>\n    <tr>\n      <th>10615</th>\n      <td>3433</td>\n      <td>snow creature</td>\n      <td>227</td>\n      <td>m</td>\n      <td>NaN</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.024586</td>\n    </tr>\n    <tr>\n      <th>10616</th>\n      <td>3433</td>\n      <td>yoda</td>\n      <td>751</td>\n      <td>m</td>\n      <td>36.0</td>\n      <td>tt0080684</td>\n      <td>Star Wars: Episode V - The Empire Strikes Back</td>\n      <td>1980</td>\n      <td>937.0</td>\n      <td>0.081339</td>\n    </tr>\n    <tr>\n      <th>10617</th>\n      <td>3437</td>\n      <td>anakin skywalke</td>\n      <td>1697</td>\n      <td>m</td>\n      <td>10.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.158037</td>\n    </tr>\n    <tr>\n      <th>10618</th>\n      <td>3437</td>\n      <td>boss nass</td>\n      <td>209</td>\n      <td>m</td>\n      <td>63.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.019464</td>\n    </tr>\n    <tr>\n      <th>10619</th>\n      <td>3437</td>\n      <td>Captain Panaka</td>\n      <td>390</td>\n      <td>m</td>\n      <td>45.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.036320</td>\n    </tr>\n    <tr>\n      <th>10620</th>\n      <td>3437</td>\n      <td>chancellor valo</td>\n      <td>127</td>\n      <td>m</td>\n      <td>61.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.011827</td>\n    </tr>\n    <tr>\n      <th>10621</th>\n      <td>3437</td>\n      <td>darth sidious</td>\n      <td>277</td>\n      <td>m</td>\n      <td>NaN</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.025796</td>\n    </tr>\n    <tr>\n      <th>10622</th>\n      <td>3437</td>\n      <td>jar jar binks</td>\n      <td>632</td>\n      <td>m</td>\n      <td>26.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.058856</td>\n    </tr>\n    <tr>\n      <th>10623</th>\n      <td>3437</td>\n      <td>mace windu</td>\n      <td>247</td>\n      <td>m</td>\n      <td>51.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.023002</td>\n    </tr>\n    <tr>\n      <th>10624</th>\n      <td>3437</td>\n      <td>nute gunray</td>\n      <td>544</td>\n      <td>m</td>\n      <td>34.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.050661</td>\n    </tr>\n    <tr>\n      <th>10625</th>\n      <td>3437</td>\n      <td>obi-wan kenobi</td>\n      <td>701</td>\n      <td>m</td>\n      <td>28.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.065282</td>\n    </tr>\n    <tr>\n      <th>10626</th>\n      <td>3437</td>\n      <td>padme</td>\n      <td>718</td>\n      <td>f</td>\n      <td>18.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.066865</td>\n    </tr>\n    <tr>\n      <th>10627</th>\n      <td>3437</td>\n      <td>queen amidala</td>\n      <td>656</td>\n      <td>f</td>\n      <td>18.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.061091</td>\n    </tr>\n    <tr>\n      <th>10628</th>\n      <td>3437</td>\n      <td>qui-gon jinn</td>\n      <td>2339</td>\n      <td>m</td>\n      <td>47.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.217825</td>\n    </tr>\n    <tr>\n      <th>10629</th>\n      <td>3437</td>\n      <td>ric oli�</td>\n      <td>132</td>\n      <td>m</td>\n      <td>42.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.012293</td>\n    </tr>\n    <tr>\n      <th>10630</th>\n      <td>3437</td>\n      <td>rune haako</td>\n      <td>126</td>\n      <td>m</td>\n      <td>NaN</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.011734</td>\n    </tr>\n    <tr>\n      <th>10631</th>\n      <td>3437</td>\n      <td>Senator Palpati</td>\n      <td>551</td>\n      <td>m</td>\n      <td>55.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.051313</td>\n    </tr>\n    <tr>\n      <th>10632</th>\n      <td>3437</td>\n      <td>shmi skywalker</td>\n      <td>414</td>\n      <td>f</td>\n      <td>41.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.038555</td>\n    </tr>\n    <tr>\n      <th>10633</th>\n      <td>3437</td>\n      <td>sio bibble</td>\n      <td>164</td>\n      <td>m</td>\n      <td>60.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.015273</td>\n    </tr>\n    <tr>\n      <th>10634</th>\n      <td>3437</td>\n      <td>watto</td>\n      <td>502</td>\n      <td>m</td>\n      <td>46.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.046750</td>\n    </tr>\n    <tr>\n      <th>10635</th>\n      <td>3437</td>\n      <td>yoda</td>\n      <td>312</td>\n      <td>m</td>\n      <td>55.0</td>\n      <td>tt0120915</td>\n      <td>Star Wars: Episode I - The Phantom Menace</td>\n      <td>1999</td>\n      <td>813.0</td>\n      <td>0.029056</td>\n    </tr>\n    <tr>\n      <th>21000</th>\n      <td>8099</td>\n      <td>bala-tik</td>\n      <td>140</td>\n      <td>m</td>\n      <td>NaN</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.021002</td>\n    </tr>\n    <tr>\n      <th>21001</th>\n      <td>8099</td>\n      <td>c-3po</td>\n      <td>138</td>\n      <td>m</td>\n      <td>69.0</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.020702</td>\n    </tr>\n    <tr>\n      <th>21002</th>\n      <td>8099</td>\n      <td>c-3po</td>\n      <td>138</td>\n      <td>m</td>\n      <td>69.0</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.020702</td>\n    </tr>\n    <tr>\n      <th>21003</th>\n      <td>8099</td>\n      <td>finn</td>\n      <td>1447</td>\n      <td>m</td>\n      <td>23.0</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.217072</td>\n    </tr>\n    <tr>\n      <th>21004</th>\n      <td>8099</td>\n      <td>general hux</td>\n      <td>356</td>\n      <td>m</td>\n      <td>32.0</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.053405</td>\n    </tr>\n    <tr>\n      <th>21005</th>\n      <td>8099</td>\n      <td>han solo</td>\n      <td>1225</td>\n      <td>m</td>\n      <td>73.0</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.183768</td>\n    </tr>\n    <tr>\n      <th>21006</th>\n      <td>8099</td>\n      <td>kylo ren</td>\n      <td>618</td>\n      <td>m</td>\n      <td>32.0</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.092709</td>\n    </tr>\n    <tr>\n      <th>21007</th>\n      <td>8099</td>\n      <td>maz kanata</td>\n      <td>241</td>\n      <td>f</td>\n      <td>32.0</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.036154</td>\n    </tr>\n    <tr>\n      <th>21008</th>\n      <td>8099</td>\n      <td>poe dameron</td>\n      <td>604</td>\n      <td>m</td>\n      <td>36.0</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.090609</td>\n    </tr>\n    <tr>\n      <th>21009</th>\n      <td>8099</td>\n      <td>princess leia</td>\n      <td>252</td>\n      <td>f</td>\n      <td>59.0</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.037804</td>\n    </tr>\n    <tr>\n      <th>21010</th>\n      <td>8099</td>\n      <td>rey</td>\n      <td>1363</td>\n      <td>f</td>\n      <td>23.0</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.204470</td>\n    </tr>\n    <tr>\n      <th>21011</th>\n      <td>8099</td>\n      <td>stormtrooper</td>\n      <td>114</td>\n      <td>m</td>\n      <td>NaN</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.017102</td>\n    </tr>\n    <tr>\n      <th>21012</th>\n      <td>8099</td>\n      <td>supreme leader</td>\n      <td>168</td>\n      <td>m</td>\n      <td>51.0</td>\n      <td>tt2488496</td>\n      <td>Star Wars: Episode VII - The Force Awakens</td>\n      <td>2015</td>\n      <td>927.0</td>\n      <td>0.025203</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:51.158259Z\",\"start_time\":\"2022-11-07T10:54:51.136396Z\"}' execution_count=12}\n``` {.python .cell-code}\ntwilight_filter = film_df['title'].str.contains('Twilight')\n```\n:::\n\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:51.292638Z\",\"start_time\":\"2022-11-07T10:54:51.260377Z\"}' tags='[\"output_scroll\",\"full-width\"]' execution_count=13}\n``` {.python .cell-code}\nfilm_df[twilight_filter]\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>script_id</th>\n      <th>character</th>\n      <th>words</th>\n      <th>gender</th>\n      <th>age</th>\n      <th>imdb_id</th>\n      <th>title</th>\n      <th>release_year</th>\n      <th>gross</th>\n      <th>proportion_of_dialogue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>11261</th>\n      <td>3621</td>\n      <td>alice cullen</td>\n      <td>146</td>\n      <td>f</td>\n      <td>21.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.010193</td>\n    </tr>\n    <tr>\n      <th>11262</th>\n      <td>3621</td>\n      <td>angela</td>\n      <td>250</td>\n      <td>f</td>\n      <td>18.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.017453</td>\n    </tr>\n    <tr>\n      <th>11263</th>\n      <td>3621</td>\n      <td>bella swan</td>\n      <td>4934</td>\n      <td>f</td>\n      <td>18.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.344457</td>\n    </tr>\n    <tr>\n      <th>11264</th>\n      <td>3621</td>\n      <td>billy black</td>\n      <td>148</td>\n      <td>m</td>\n      <td>55.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.010332</td>\n    </tr>\n    <tr>\n      <th>11265</th>\n      <td>3621</td>\n      <td>charlie swan</td>\n      <td>1256</td>\n      <td>m</td>\n      <td>42.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.087685</td>\n    </tr>\n    <tr>\n      <th>11266</th>\n      <td>3621</td>\n      <td>edward cullen</td>\n      <td>3680</td>\n      <td>m</td>\n      <td>22.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.256911</td>\n    </tr>\n    <tr>\n      <th>11267</th>\n      <td>3621</td>\n      <td>eric</td>\n      <td>308</td>\n      <td>m</td>\n      <td>27.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.021502</td>\n    </tr>\n    <tr>\n      <th>11268</th>\n      <td>3621</td>\n      <td>esme cullen</td>\n      <td>162</td>\n      <td>f</td>\n      <td>33.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.011310</td>\n    </tr>\n    <tr>\n      <th>11269</th>\n      <td>3621</td>\n      <td>jacob black</td>\n      <td>342</td>\n      <td>m</td>\n      <td>16.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.023876</td>\n    </tr>\n    <tr>\n      <th>11270</th>\n      <td>3621</td>\n      <td>james</td>\n      <td>778</td>\n      <td>m</td>\n      <td>26.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.054314</td>\n    </tr>\n    <tr>\n      <th>11271</th>\n      <td>3621</td>\n      <td>jasper</td>\n      <td>222</td>\n      <td>m</td>\n      <td>24.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.015498</td>\n    </tr>\n    <tr>\n      <th>11272</th>\n      <td>3621</td>\n      <td>jessica</td>\n      <td>624</td>\n      <td>f</td>\n      <td>23.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.043563</td>\n    </tr>\n    <tr>\n      <th>11273</th>\n      <td>3621</td>\n      <td>laurent</td>\n      <td>294</td>\n      <td>m</td>\n      <td>29.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.020525</td>\n    </tr>\n    <tr>\n      <th>11274</th>\n      <td>3621</td>\n      <td>mike newton</td>\n      <td>160</td>\n      <td>m</td>\n      <td>21.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.011170</td>\n    </tr>\n    <tr>\n      <th>11275</th>\n      <td>3621</td>\n      <td>mr. molina</td>\n      <td>250</td>\n      <td>m</td>\n      <td>NaN</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.017453</td>\n    </tr>\n    <tr>\n      <th>11276</th>\n      <td>3621</td>\n      <td>ren�e</td>\n      <td>584</td>\n      <td>f</td>\n      <td>36.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.040771</td>\n    </tr>\n    <tr>\n      <th>11277</th>\n      <td>3621</td>\n      <td>rosalie</td>\n      <td>186</td>\n      <td>f</td>\n      <td>20.0</td>\n      <td>tt1099212</td>\n      <td>Twilight</td>\n      <td>2008</td>\n      <td>231.0</td>\n      <td>0.012985</td>\n    </tr>\n    <tr>\n      <th>15410</th>\n      <td>5163</td>\n      <td>bella swan</td>\n      <td>846</td>\n      <td>f</td>\n      <td>20.0</td>\n      <td>tt1325004</td>\n      <td>The Twilight Saga: Eclipse</td>\n      <td>2010</td>\n      <td>331.0</td>\n      <td>0.357264</td>\n    </tr>\n    <tr>\n      <th>15411</th>\n      <td>5163</td>\n      <td>dr. carlisle cu</td>\n      <td>128</td>\n      <td>m</td>\n      <td>37.0</td>\n      <td>tt1325004</td>\n      <td>The Twilight Saga: Eclipse</td>\n      <td>2010</td>\n      <td>331.0</td>\n      <td>0.054054</td>\n    </tr>\n    <tr>\n      <th>15412</th>\n      <td>5163</td>\n      <td>edward cullen</td>\n      <td>677</td>\n      <td>m</td>\n      <td>24.0</td>\n      <td>tt1325004</td>\n      <td>The Twilight Saga: Eclipse</td>\n      <td>2010</td>\n      <td>331.0</td>\n      <td>0.285895</td>\n    </tr>\n    <tr>\n      <th>15413</th>\n      <td>5163</td>\n      <td>jacob black</td>\n      <td>419</td>\n      <td>m</td>\n      <td>18.0</td>\n      <td>tt1325004</td>\n      <td>The Twilight Saga: Eclipse</td>\n      <td>2010</td>\n      <td>331.0</td>\n      <td>0.176943</td>\n    </tr>\n    <tr>\n      <th>15414</th>\n      <td>5163</td>\n      <td>jasper hale</td>\n      <td>187</td>\n      <td>m</td>\n      <td>26.0</td>\n      <td>tt1325004</td>\n      <td>The Twilight Saga: Eclipse</td>\n      <td>2010</td>\n      <td>331.0</td>\n      <td>0.078970</td>\n    </tr>\n    <tr>\n      <th>15415</th>\n      <td>5163</td>\n      <td>rosalie hale</td>\n      <td>111</td>\n      <td>f</td>\n      <td>22.0</td>\n      <td>tt1325004</td>\n      <td>The Twilight Saga: Eclipse</td>\n      <td>2010</td>\n      <td>331.0</td>\n      <td>0.046875</td>\n    </tr>\n    <tr>\n      <th>15416</th>\n      <td>5164</td>\n      <td>alice cullen</td>\n      <td>1200</td>\n      <td>f</td>\n      <td>22.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.066467</td>\n    </tr>\n    <tr>\n      <th>15417</th>\n      <td>5164</td>\n      <td>angela</td>\n      <td>138</td>\n      <td>f</td>\n      <td>19.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.007644</td>\n    </tr>\n    <tr>\n      <th>15418</th>\n      <td>5164</td>\n      <td>aro</td>\n      <td>442</td>\n      <td>m</td>\n      <td>40.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.024482</td>\n    </tr>\n    <tr>\n      <th>15419</th>\n      <td>5164</td>\n      <td>bella swan</td>\n      <td>6542</td>\n      <td>f</td>\n      <td>19.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.362357</td>\n    </tr>\n    <tr>\n      <th>15420</th>\n      <td>5164</td>\n      <td>charlie swan</td>\n      <td>878</td>\n      <td>m</td>\n      <td>43.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.048632</td>\n    </tr>\n    <tr>\n      <th>15421</th>\n      <td>5164</td>\n      <td>dr. carlisle cu</td>\n      <td>318</td>\n      <td>m</td>\n      <td>36.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.017614</td>\n    </tr>\n    <tr>\n      <th>15422</th>\n      <td>5164</td>\n      <td>edward cullen</td>\n      <td>2470</td>\n      <td>m</td>\n      <td>23.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.136812</td>\n    </tr>\n    <tr>\n      <th>15423</th>\n      <td>5164</td>\n      <td>embry call</td>\n      <td>396</td>\n      <td>m</td>\n      <td>19.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.021934</td>\n    </tr>\n    <tr>\n      <th>15424</th>\n      <td>5164</td>\n      <td>emily</td>\n      <td>154</td>\n      <td>f</td>\n      <td>NaN</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.008530</td>\n    </tr>\n    <tr>\n      <th>15425</th>\n      <td>5164</td>\n      <td>emmett cullen</td>\n      <td>152</td>\n      <td>m</td>\n      <td>24.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.008419</td>\n    </tr>\n    <tr>\n      <th>15426</th>\n      <td>5164</td>\n      <td>jacob black</td>\n      <td>3556</td>\n      <td>m</td>\n      <td>17.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.196965</td>\n    </tr>\n    <tr>\n      <th>15427</th>\n      <td>5164</td>\n      <td>jared</td>\n      <td>256</td>\n      <td>m</td>\n      <td>23.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.014180</td>\n    </tr>\n    <tr>\n      <th>15428</th>\n      <td>5164</td>\n      <td>jessica</td>\n      <td>314</td>\n      <td>f</td>\n      <td>24.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.017392</td>\n    </tr>\n    <tr>\n      <th>15429</th>\n      <td>5164</td>\n      <td>laurent</td>\n      <td>492</td>\n      <td>m</td>\n      <td>30.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.027252</td>\n    </tr>\n    <tr>\n      <th>15430</th>\n      <td>5164</td>\n      <td>rosalie hale</td>\n      <td>298</td>\n      <td>f</td>\n      <td>21.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.016506</td>\n    </tr>\n    <tr>\n      <th>15431</th>\n      <td>5164</td>\n      <td>sam uley</td>\n      <td>316</td>\n      <td>m</td>\n      <td>34.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.017503</td>\n    </tr>\n    <tr>\n      <th>15432</th>\n      <td>5164</td>\n      <td>victoria</td>\n      <td>132</td>\n      <td>f</td>\n      <td>30.0</td>\n      <td>tt1259571</td>\n      <td>The Twilight Saga: New Moon</td>\n      <td>2009</td>\n      <td>344.0</td>\n      <td>0.007311</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nMake your own filter with `.str.contains()`\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:51.790904Z\",\"start_time\":\"2022-11-07T10:54:51.785447Z\"}' execution_count=14}\n``` {.python .cell-code}\nnew_filter = ...\n```\n:::\n\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:58.872540Z\",\"start_time\":\"2022-11-07T10:54:58.869576Z\"}' execution_count=15}\n``` {.python .cell-code}\n# film_df[new_filter]\n```\n:::\n\n\n## Applying Functions\n\nYou can apply Python functions to DataFrames with multiple different methods. We will explore two of them here.\n\nLet's say we want to transform the \"gross\" column, which reports how much money each film made, into a full number. Right now if a film made $2 million, it simply says `2.0`. But maybe we want it to say `20000000`.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:59.557463Z\",\"start_time\":\"2022-11-07T10:54:59.551545Z\"}' execution_count=16}\n``` {.python .cell-code}\ndef make_millions(number):\n    new_number = number * 1000000\n    return new_number\n```\n:::\n\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:54:59.735455Z\",\"start_time\":\"2022-11-07T10:54:59.725908Z\"}' execution_count=17}\n``` {.python .cell-code}\nmake_millions(2.0)\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```\n2000000.0\n```\n:::\n:::\n\n\n### Method 1\n\nYou can use regular Python to loop through the Series `film_df['gross']` and make a list with all your new values.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:00.301150Z\",\"start_time\":\"2022-11-07T10:55:00.275391Z\"}' execution_count=18}\n``` {.python .cell-code}\ngross_in_millions = []\nfor gross in film_df['gross']:\n    gross_mill = make_millions(gross)\n    gross_in_millions.append(gross_mill)\n```\n:::\n\n\nThen you can add that list as a new column to the DataFrame.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:00.930612Z\",\"start_time\":\"2022-11-07T10:55:00.915337Z\"}' execution_count=19}\n``` {.python .cell-code}\nfilm_df['gross_millions'] = gross_in_millions\n```\n:::\n\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:01.159362Z\",\"start_time\":\"2022-11-07T10:55:01.127563Z\"}' execution_count=20}\n``` {.python .cell-code}\nfilm_df\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>script_id</th>\n      <th>character</th>\n      <th>words</th>\n      <th>gender</th>\n      <th>age</th>\n      <th>imdb_id</th>\n      <th>title</th>\n      <th>release_year</th>\n      <th>gross</th>\n      <th>proportion_of_dialogue</th>\n      <th>gross_millions</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>280</td>\n      <td>betty</td>\n      <td>311</td>\n      <td>f</td>\n      <td>35.0</td>\n      <td>tt0112579</td>\n      <td>The Bridges of Madison County</td>\n      <td>1995</td>\n      <td>142.0</td>\n      <td>0.048639</td>\n      <td>142000000.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>280</td>\n      <td>carolyn johnson</td>\n      <td>873</td>\n      <td>f</td>\n      <td>NaN</td>\n      <td>tt0112579</td>\n      <td>The Bridges of Madison County</td>\n      <td>1995</td>\n      <td>142.0</td>\n      <td>0.136534</td>\n      <td>142000000.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>280</td>\n      <td>eleanor</td>\n      <td>138</td>\n      <td>f</td>\n      <td>NaN</td>\n      <td>tt0112579</td>\n      <td>The Bridges of Madison County</td>\n      <td>1995</td>\n      <td>142.0</td>\n      <td>0.021583</td>\n      <td>142000000.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>280</td>\n      <td>francesca johns</td>\n      <td>2251</td>\n      <td>f</td>\n      <td>46.0</td>\n      <td>tt0112579</td>\n      <td>The Bridges of Madison County</td>\n      <td>1995</td>\n      <td>142.0</td>\n      <td>0.352049</td>\n      <td>142000000.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>280</td>\n      <td>madge</td>\n      <td>190</td>\n      <td>f</td>\n      <td>46.0</td>\n      <td>tt0112579</td>\n      <td>The Bridges of Madison County</td>\n      <td>1995</td>\n      <td>142.0</td>\n      <td>0.029715</td>\n      <td>142000000.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>23047</th>\n      <td>9254</td>\n      <td>maurice</td>\n      <td>1107</td>\n      <td>m</td>\n      <td>71.0</td>\n      <td>tt0101414</td>\n      <td>Beauty and the Beast</td>\n      <td>1991</td>\n      <td>452.0</td>\n      <td>0.108967</td>\n      <td>452000000.0</td>\n    </tr>\n    <tr>\n      <th>23048</th>\n      <td>9254</td>\n      <td>monsieur d'arqu</td>\n      <td>114</td>\n      <td>m</td>\n      <td>58.0</td>\n      <td>tt0101414</td>\n      <td>Beauty and the Beast</td>\n      <td>1991</td>\n      <td>452.0</td>\n      <td>0.011222</td>\n      <td>452000000.0</td>\n    </tr>\n    <tr>\n      <th>23049</th>\n      <td>9254</td>\n      <td>mrs. potts</td>\n      <td>564</td>\n      <td>f</td>\n      <td>66.0</td>\n      <td>tt0101414</td>\n      <td>Beauty and the Beast</td>\n      <td>1991</td>\n      <td>452.0</td>\n      <td>0.055517</td>\n      <td>452000000.0</td>\n    </tr>\n    <tr>\n      <th>23050</th>\n      <td>9254</td>\n      <td>wardrobe</td>\n      <td>121</td>\n      <td>f</td>\n      <td>54.0</td>\n      <td>tt0101414</td>\n      <td>Beauty and the Beast</td>\n      <td>1991</td>\n      <td>452.0</td>\n      <td>0.011911</td>\n      <td>452000000.0</td>\n    </tr>\n    <tr>\n      <th>23051</th>\n      <td>9254</td>\n      <td>mrs. potts</td>\n      <td>564</td>\n      <td>f</td>\n      <td>66.0</td>\n      <td>tt0101414</td>\n      <td>Beauty and the Beast</td>\n      <td>1991</td>\n      <td>452.0</td>\n      <td>0.055517</td>\n      <td>452000000.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>23052 rows × 11 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Method 2\n\nYou can directly apply a function to every row in a column (or Series) with a special Pandas methods called `.apply()`.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:01.871744Z\",\"start_time\":\"2022-11-07T10:55:01.850173Z\"}' execution_count=21}\n``` {.python .cell-code}\nfilm_df['gross_millions2'] = film_df['gross'].apply(make_millions)\n```\n:::\n\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:02.043160Z\",\"start_time\":\"2022-11-07T10:55:02.014264Z\"}' execution_count=22}\n``` {.python .cell-code}\nfilm_df\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>script_id</th>\n      <th>character</th>\n      <th>words</th>\n      <th>gender</th>\n      <th>age</th>\n      <th>imdb_id</th>\n      <th>title</th>\n      <th>release_year</th>\n      <th>gross</th>\n      <th>proportion_of_dialogue</th>\n      <th>gross_millions</th>\n      <th>gross_millions2</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>280</td>\n      <td>betty</td>\n      <td>311</td>\n      <td>f</td>\n      <td>35.0</td>\n      <td>tt0112579</td>\n      <td>The Bridges of Madison County</td>\n      <td>1995</td>\n      <td>142.0</td>\n      <td>0.048639</td>\n      <td>142000000.0</td>\n      <td>142000000.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>280</td>\n      <td>carolyn johnson</td>\n      <td>873</td>\n      <td>f</td>\n      <td>NaN</td>\n      <td>tt0112579</td>\n      <td>The Bridges of Madison County</td>\n      <td>1995</td>\n      <td>142.0</td>\n      <td>0.136534</td>\n      <td>142000000.0</td>\n      <td>142000000.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>280</td>\n      <td>eleanor</td>\n      <td>138</td>\n      <td>f</td>\n      <td>NaN</td>\n      <td>tt0112579</td>\n      <td>The Bridges of Madison County</td>\n      <td>1995</td>\n      <td>142.0</td>\n      <td>0.021583</td>\n      <td>142000000.0</td>\n      <td>142000000.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>280</td>\n      <td>francesca johns</td>\n      <td>2251</td>\n      <td>f</td>\n      <td>46.0</td>\n      <td>tt0112579</td>\n      <td>The Bridges of Madison County</td>\n      <td>1995</td>\n      <td>142.0</td>\n      <td>0.352049</td>\n      <td>142000000.0</td>\n      <td>142000000.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>280</td>\n      <td>madge</td>\n      <td>190</td>\n      <td>f</td>\n      <td>46.0</td>\n      <td>tt0112579</td>\n      <td>The Bridges of Madison County</td>\n      <td>1995</td>\n      <td>142.0</td>\n      <td>0.029715</td>\n      <td>142000000.0</td>\n      <td>142000000.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>23047</th>\n      <td>9254</td>\n      <td>maurice</td>\n      <td>1107</td>\n      <td>m</td>\n      <td>71.0</td>\n      <td>tt0101414</td>\n      <td>Beauty and the Beast</td>\n      <td>1991</td>\n      <td>452.0</td>\n      <td>0.108967</td>\n      <td>452000000.0</td>\n      <td>452000000.0</td>\n    </tr>\n    <tr>\n      <th>23048</th>\n      <td>9254</td>\n      <td>monsieur d'arqu</td>\n      <td>114</td>\n      <td>m</td>\n      <td>58.0</td>\n      <td>tt0101414</td>\n      <td>Beauty and the Beast</td>\n      <td>1991</td>\n      <td>452.0</td>\n      <td>0.011222</td>\n      <td>452000000.0</td>\n      <td>452000000.0</td>\n    </tr>\n    <tr>\n      <th>23049</th>\n      <td>9254</td>\n      <td>mrs. potts</td>\n      <td>564</td>\n      <td>f</td>\n      <td>66.0</td>\n      <td>tt0101414</td>\n      <td>Beauty and the Beast</td>\n      <td>1991</td>\n      <td>452.0</td>\n      <td>0.055517</td>\n      <td>452000000.0</td>\n      <td>452000000.0</td>\n    </tr>\n    <tr>\n      <th>23050</th>\n      <td>9254</td>\n      <td>wardrobe</td>\n      <td>121</td>\n      <td>f</td>\n      <td>54.0</td>\n      <td>tt0101414</td>\n      <td>Beauty and the Beast</td>\n      <td>1991</td>\n      <td>452.0</td>\n      <td>0.011911</td>\n      <td>452000000.0</td>\n      <td>452000000.0</td>\n    </tr>\n    <tr>\n      <th>23051</th>\n      <td>9254</td>\n      <td>mrs. potts</td>\n      <td>564</td>\n      <td>f</td>\n      <td>66.0</td>\n      <td>tt0101414</td>\n      <td>Beauty and the Beast</td>\n      <td>1991</td>\n      <td>452.0</td>\n      <td>0.055517</td>\n      <td>452000000.0</td>\n      <td>452000000.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>23052 rows × 12 columns</p>\n</div>\n```\n:::\n:::\n\n\nLet's transform the column `proportion_of_dialogue` into a percentage, e.g., .02 -> 2.\n\nMake a Python function called `make_percent()` that will take in a number and then return that number mutlipled by 100.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:08.275850Z\",\"start_time\":\"2022-11-07T10:55:08.270759Z\"}' execution_count=23}\n``` {.python .cell-code}\n# def ...\n```\n:::\n\n\nMake a new column \"percentage_of_dialogue\" by applying this function to the \"proportion of dialogue\" column.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:10.364440Z\",\"start_time\":\"2022-11-07T10:55:10.360730Z\"}' execution_count=24}\n``` {.python .cell-code}\n# film_df['percentage_of_dialogue'] = ...\n```\n:::\n\n\n## More Useful Methods\n\n### Make a Series into a DataFrame\n\nHere's a Series:\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:11.176775Z\",\"start_time\":\"2022-11-07T10:55:11.153753Z\"}' execution_count=25}\n``` {.python .cell-code}\nfilm_df.groupby('title')['words'].sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=25}\n```\ntitle\n(500) Days of Summer          18500\n10 Things I Hate About You    19680\n12 Years a Slave              19628\n12 and Holding                15968\n127 Hours                      5145\n                              ...  \nZero Effect                   13927\nZerophilia                    16686\nZodiac                        14656\neXistenZ                       9447\nxXx                            8285\nName: words, Length: 1994, dtype: int64\n```\n:::\n:::\n\n\nYou can make a Series object into a DataFrame object by using two square brackets instead of one.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:11.706097Z\",\"start_time\":\"2022-11-07T10:55:11.677045Z\"}' execution_count=26}\n``` {.python .cell-code}\nfilm_df.groupby('title')[['words']].sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=26}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>words</th>\n    </tr>\n    <tr>\n      <th>title</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>(500) Days of Summer</th>\n      <td>18500</td>\n    </tr>\n    <tr>\n      <th>10 Things I Hate About You</th>\n      <td>19680</td>\n    </tr>\n    <tr>\n      <th>12 Years a Slave</th>\n      <td>19628</td>\n    </tr>\n    <tr>\n      <th>12 and Holding</th>\n      <td>15968</td>\n    </tr>\n    <tr>\n      <th>127 Hours</th>\n      <td>5145</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>Zero Effect</th>\n      <td>13927</td>\n    </tr>\n    <tr>\n      <th>Zerophilia</th>\n      <td>16686</td>\n    </tr>\n    <tr>\n      <th>Zodiac</th>\n      <td>14656</td>\n    </tr>\n    <tr>\n      <th>eXistenZ</th>\n      <td>9447</td>\n    </tr>\n    <tr>\n      <th>xXx</th>\n      <td>8285</td>\n    </tr>\n  </tbody>\n</table>\n<p>1994 rows × 1 columns</p>\n</div>\n```\n:::\n:::\n\n\nBut perhaps the most useful method, especially after grouping by a category, is to use `.reset_index()`. The index is \"reset\" to ascending numbers, and the groupby category becomes a regular column.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:12.066669Z\",\"start_time\":\"2022-11-07T10:55:12.041879Z\"}' execution_count=27}\n``` {.python .cell-code}\nfilm_df.groupby('title')[['words']].sum().reset_index()\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>title</th>\n      <th>words</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>(500) Days of Summer</td>\n      <td>18500</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>10 Things I Hate About You</td>\n      <td>19680</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>12 Years a Slave</td>\n      <td>19628</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>12 and Holding</td>\n      <td>15968</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>127 Hours</td>\n      <td>5145</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>1989</th>\n      <td>Zero Effect</td>\n      <td>13927</td>\n    </tr>\n    <tr>\n      <th>1990</th>\n      <td>Zerophilia</td>\n      <td>16686</td>\n    </tr>\n    <tr>\n      <th>1991</th>\n      <td>Zodiac</td>\n      <td>14656</td>\n    </tr>\n    <tr>\n      <th>1992</th>\n      <td>eXistenZ</td>\n      <td>9447</td>\n    </tr>\n    <tr>\n      <th>1993</th>\n      <td>xXx</td>\n      <td>8285</td>\n    </tr>\n  </tbody>\n</table>\n<p>1994 rows × 2 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Change Data Types\n\nYou can convert data types with `.astype()` ([documentation here](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.astype.html)).\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:12.683581Z\",\"start_time\":\"2022-11-07T10:55:12.648301Z\"}' execution_count=28}\n``` {.python .cell-code}\nfilm_df.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 23052 entries, 0 to 23051\nData columns (total 12 columns):\n #   Column                  Non-Null Count  Dtype  \n---  ------                  --------------  -----  \n 0   script_id               23052 non-null  int64  \n 1   character               23050 non-null  object \n 2   words                   23052 non-null  int64  \n 3   gender                  23052 non-null  object \n 4   age                     18266 non-null  float64\n 5   imdb_id                 23052 non-null  object \n 6   title                   23052 non-null  object \n 7   release_year            23052 non-null  int64  \n 8   gross                   19390 non-null  float64\n 9   proportion_of_dialogue  23052 non-null  float64\n 10  gross_millions          19390 non-null  float64\n 11  gross_millions2         19390 non-null  float64\ndtypes: float64(5), int64(3), object(4)\nmemory usage: 2.1+ MB\n```\n:::\n:::\n\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:12.874834Z\",\"start_time\":\"2022-11-07T10:55:12.844851Z\"}' execution_count=29}\n``` {.python .cell-code}\nfilm_df['script_id'].astype('str')\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```\n0         280\n1         280\n2         280\n3         280\n4         280\n         ... \n23047    9254\n23048    9254\n23049    9254\n23050    9254\n23051    9254\nName: script_id, Length: 23052, dtype: object\n```\n:::\n:::\n\n\nTry to convert \"age\" to an integer and see what happens...\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:25.991628Z\",\"start_time\":\"2022-11-07T10:55:25.986265Z\"}' execution_count=30}\n``` {.python .cell-code}\n# film_df['age'].astype(int)\n```\n:::\n\n\nPandas says that you cannot convert NaN values to integers. If we're ok with keeping the Nan values, we can simply choose to \"ignore\" the errors.\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:27.079714Z\",\"start_time\":\"2022-11-07T10:55:27.066231Z\"}' execution_count=31}\n``` {.python .cell-code}\nfilm_df['age'].astype(int, errors='ignore')\n```\n\n::: {.cell-output .cell-output-display execution_count=31}\n```\n0        35.0\n1         NaN\n2         NaN\n3        46.0\n4        46.0\n         ... \n23047    71.0\n23048    58.0\n23049    66.0\n23050    54.0\n23051    66.0\nName: age, Length: 23052, dtype: float64\n```\n:::\n:::\n\n\nConvert to a datetime data type\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:27.867503Z\",\"start_time\":\"2022-11-07T10:55:27.846130Z\"}' execution_count=32}\n``` {.python .cell-code}\npd.to_datetime(film_df['release_year'], format='%Y')\n```\n\n::: {.cell-output .cell-output-display execution_count=32}\n```\n0       1995-01-01\n1       1995-01-01\n2       1995-01-01\n3       1995-01-01\n4       1995-01-01\n           ...    \n23047   1991-01-01\n23048   1991-01-01\n23049   1991-01-01\n23050   1991-01-01\n23051   1991-01-01\nName: release_year, Length: 23052, dtype: datetime64[ns]\n```\n:::\n:::\n\n\n### Binning\n\nYou can use `pd.cut()` to bin values ([documentation here](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.cut.html)).\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:28.383990Z\",\"start_time\":\"2022-11-07T10:55:28.366510Z\"}' execution_count=33}\n``` {.python .cell-code}\npd.cut(film_df['age'], bins=[0, 25, 50, 75, 100], labels= ['0-25', '25-50', '50-75', '75-100'])\n```\n\n::: {.cell-output .cell-output-display execution_count=33}\n```\n0        25-50\n1          NaN\n2          NaN\n3        25-50\n4        25-50\n         ...  \n23047    50-75\n23048    50-75\n23049    50-75\n23050    50-75\n23051    50-75\nName: age, Length: 23052, dtype: category\nCategories (4, object): ['0-25' < '25-50' < '50-75' < '75-100']\n```\n:::\n:::\n\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:28.538960Z\",\"start_time\":\"2022-11-07T10:55:28.529564Z\"}' execution_count=34}\n``` {.python .cell-code}\nbinned_age = pd.cut(film_df['age'], bins=[0, 25, 50, 75, 100], labels= ['0-25', '25-50', '50-75', '75-100'])\n```\n:::\n\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:29.626383Z\",\"start_time\":\"2022-11-07T10:55:28.691304Z\"}' execution_count=35}\n``` {.python .cell-code}\nbinned_age.value_counts().plot(kind='bar')\n```\n\n::: {.cell-output .cell-output-display execution_count=35}\n```\n<AxesSubplot:>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](06-Pandas-Basics-More-Methods-WORKBOOK_files/figure-html/cell-36-output-2.png){}\n:::\n:::\n\n\n::: {.cell ExecuteTime='{\"end_time\":\"2022-11-07T10:55:29.750427Z\",\"start_time\":\"2022-11-07T10:55:29.648598Z\"}' execution_count=36}\n``` {.python .cell-code}\nfilm_df['age'].hist(bins=[0, 25, 50, 75, 100])\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n```\n<AxesSubplot:>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](06-Pandas-Basics-More-Methods-WORKBOOK_files/figure-html/cell-37-output-2.png){}\n:::\n:::\n\n\n",
    "supporting": [
      "06-Pandas-Basics-More-Methods-WORKBOOK_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}